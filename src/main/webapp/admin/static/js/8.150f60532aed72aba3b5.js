webpackJsonp([8],{Xc4u:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i={name:"basetable",data:()=>({activeName:"first",modelTitle:"新闻详情",tableData:[],tableData1:[],modelVisible:!1,addForm:{},file:{},size:10,page:1,totalElements:0,size1:10,page1:1,totalElements1:0,loading:!0,addLoading:!1}),created(){this.getData(1,this.page,this.size)},computed:{},methods:{deleteTP(){this.addForm.xwtp="",this.file={}},getFile(t){this.file=t.target.files[0],this.addForm.xwtp=this.file},closeClear(){this.$refs.addForm.resetFields()},handleClick(t,e){"first"===t.name?this.getData(1,this.page,this.size):this.getData(2,this.page1,this.size1)},delFile(t,e){this.$confirm("是否确定删除该新闻?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$axios.post("/api/news/delete",this.$qs.stringify({id:e.id})).then(t=>{this.$message.success("已删除！"),"first"==this.activeName?this.getData(1,this.page,this.size):this.getData(2,this.page1,this.size1)})}).catch(()=>{})},formatterWjlx(t){return this.$common.dictParse(t.wjlx,this.$dict.fileType)},editFile(t,e){this.addForm=Object.assign({},e),this.file={},this.modelVisible=!0},modelClose(t){this.$refs[t].resetFields()},getFile(t){this.file=t.target.files[0],this.addForm.file=this.file},handleCurrentChange(t){this.page=t,this.getData(1,this.page,this.size)},handleCurrentChange1(t){this.page1=t,this.getData(2,this.page1,this.size1)},getData(t,e,a){this.loading=!0,this.$axios.post("/api/news/findAllByGsidByPage",this.$qs.stringify({xwlx:t,page:e,size:a})).then(e=>{200==e.resCode&&(this.loading=!1,1===t?(this.tableData=e.data.content,this.totalElements=e.data.totalElements):(this.tableData1=e.data.content,this.totalElements1=e.data.totalElements))})},add(){this.addForm={},this.modelVisible=!0},saveEdit(t){this.$refs.addForm.validate(t=>{if(t){this.addLoading=!0;let t="/api/news/add";this.addForm.id&&(t="/api/news/update");let a=new FormData;for(let t in this.addForm)a.append(t,this.addForm[t]);for(var e of a.values())console.log(e);let i={headers:{"Content-Type":"multipart/form-data"}};this.$axios.post(t,a,i).then(t=>{this.addLoading=!1,this.modelVisible=!1,"first"==this.activeName?this.getData(1,this.page,this.size):this.getData(2,this.page1,this.size1)})}})}}},l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"table"},[a("div",{staticClass:"crumbs"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[a("i",{staticClass:"el-icon-lx-cascades"}),t._v(" 新闻管理")])],1)],1),t._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"container"},[a("el-tabs",{on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"公司新闻",name:"first"}},[a("el-table",{ref:"multipleTable",staticClass:"table",attrs:{data:t.tableData,"show-header":!1}},[a("el-table-column",{attrs:{prop:"xwbt",label:"新闻标题"}}),t._v(" "),a("el-table-column",{attrs:{prop:"xwnr",label:"新闻内容","show-overflow-tooltip":!0}}),t._v(" "),a("el-table-column",{attrs:{prop:"cjsj",label:"创建时间",width:"160"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center",width:"160"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",icon:"el-icon-lx-edit"},on:{click:function(a){t.editFile(e.$index,e.row)}}},[t._v("编辑\n                            ")]),t._v(" "),a("el-button",{staticClass:"red",attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(a){t.delFile(e.$index,e.row)}}},[t._v("删除\n                            ")])]}}])})],1),t._v(" "),a("div",{staticStyle:{padding:"28px 8px"}},[a("el-button",{staticStyle:{float:"left"},attrs:{type:"primary"},on:{click:t.add}},[t._v("上传新闻")]),t._v(" "),a("el-pagination",{staticStyle:{float:"right"},attrs:{"current-page":t.page,"page-size":t.size,layout:"prev, pager, next",total:t.totalElements},on:{"current-change":t.handleCurrentChange}})],1)],1),t._v(" "),a("el-tab-pane",{attrs:{label:"行业新闻",name:"second"}},[a("el-table",{ref:"multipleTable",staticClass:"table",attrs:{data:t.tableData1,"show-header":!1}},[a("el-table-column",{attrs:{prop:"xwbt",label:"新闻标题"}}),t._v(" "),a("el-table-column",{attrs:{prop:"xwnr",label:"新闻内容","show-overflow-tooltip":!0}}),t._v(" "),a("el-table-column",{attrs:{prop:"cjsj",label:"创建时间",width:"160"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center",width:"160"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",icon:"el-icon-lx-edit"},on:{click:function(a){t.editFile(e.$index,e.row)}}},[t._v("编辑\n                            ")]),t._v(" "),a("el-button",{staticClass:"red",attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(a){t.delFile(e.$index,e.row)}}},[t._v("删除\n                            ")])]}}])})],1),t._v(" "),a("div",{staticStyle:{padding:"28px 8px"}},[a("el-button",{staticStyle:{float:"left"},attrs:{type:"primary"},on:{click:t.add}},[t._v("上传新闻")]),t._v(" "),a("el-pagination",{staticStyle:{float:"right"},attrs:{"current-page":t.page1,"page-size":t.size1,layout:"prev, pager, next",total:t.totalElements1},on:{"current-change":t.handleCurrentChange1}})],1)],1)],1)],1),t._v(" "),a("el-dialog",{attrs:{title:t.modelTitle,visible:t.modelVisible,width:"60%","close-on-click-modal":!1},on:{"update:visible":function(e){t.modelVisible=e},closed:t.closeClear}},[a("el-form",{ref:"addForm",attrs:{model:t.addForm,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"新闻标题",prop:"xwbt",rules:[{required:!0,message:"新闻标题不能为空",trigger:"blur"}]}},[a("el-input",{model:{value:t.addForm.xwbt,callback:function(e){t.$set(t.addForm,"xwbt",e)},expression:"addForm.xwbt"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"新闻内容",prop:"xwnr",rules:[{required:!0,message:"新闻内容不能为空",trigger:"blur"}]}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:5,maxRows:18}},model:{value:t.addForm.xwnr,callback:function(e){t.$set(t.addForm,"xwnr",e)},expression:"addForm.xwnr"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"新闻类型",prop:"xwlx",rules:[{required:!0,message:"新闻类型不能为空",trigger:"blur"}]}},[a("el-select",{attrs:{placeholder:"请选择新闻类型"},model:{value:t.addForm.xwlx,callback:function(e){t.$set(t.addForm,"xwlx",e)},expression:"addForm.xwlx"}},t._l(this.$dict.newType,function(t){return a("el-option",{key:2.0395*t.id,attrs:{label:t.name,value:t.id}})}),1)],1),t._v(" "),t.addForm.id&&t.addForm.xwtp?t._e():a("el-form-item",{attrs:{label:"新闻图片"}},[a("input",{attrs:{type:"file"},on:{change:function(e){t.getFile(e)}}})]),t._v(" "),t.addForm.xwtp?a("el-form-item",{attrs:{label:"新闻图片"}},[a("div",{staticStyle:{position:"relative",display:"inline-block",width:"auto",height:"auto"}},[a("img",{staticClass:"image",attrs:{src:"http://182.151.22.247:8081"+t.addForm.xwtp,alt:""}}),t._v(" "),t.addForm.xwtp?a("i",{staticClass:"el-icon-error image-icon",on:{click:t.deleteTP}}):t._e()])]):t._e()],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.modelVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary",loading:t.addLoading},on:{click:function(e){t.saveEdit(t.addForm)}}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var s=a("C7Lr")(i,l,!1,function(t){a("vV8N")},"data-v-256e470b",null);e.default=s.exports},vV8N:function(t,e){}});